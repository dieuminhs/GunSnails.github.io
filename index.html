<!DOCTYPE html>
<html>

<head>
    <title>Untitled</title>
    <style>
        body {
            background-color: red;
        }
        
        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>

</head>

<body>

    <script src="pixi.min.js"></script>

    <script>
        var enabled = true;


        //extend PIXI.Graphics to modify its _renderWebGL function
        function GraphicsNoBlending() {
            PIXI.Graphics.call(this);
        }
        GraphicsNoBlending.prototype = Object.create(PIXI.Graphics.prototype);
        GraphicsNoBlending.prototype.constructor = GraphicsNoBlending;
        GraphicsNoBlending.prototype._renderWebGL = function(renderer) {

            //////////////copy-paste from PIXI.Graphics._renderWebGL
            if (this.glDirty) {
                this.dirty = true;
                this.glDirty = false;
            }

            renderer.setObjectRenderer(renderer.plugins.graphics);
            //////////////////////////

            var gl = renderer.gl;
            gl.disable(gl.BLEND);
            renderer.plugins.graphics.render(this);
            gl.enable(gl.BLEND);
        };


        //extend PIXI.Graphics to make it only draw on non-transparent pixels
        function ShadowGraphics() {
            PIXI.Graphics.call(this);
        }
        ShadowGraphics.prototype = Object.create(PIXI.Graphics.prototype);
        ShadowGraphics.prototype.constructor = ShadowGraphics;
        ShadowGraphics.prototype._renderWebGL = function(renderer) {

            //////////////copy-paste from PIXI.Graphics._renderWebGL
            if (this.glDirty) {
                this.dirty = true;
                this.glDirty = false;
            }

            renderer.setObjectRenderer(renderer.plugins.graphics);
            //////////////////////////////////

            var gl = renderer.gl;
            gl.blendFuncSeparate(gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ZERO, gl.ONE);
            renderer.plugins.graphics.render(this);
            gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
        };

        PIXI.loader
            .add('image', 'image/Tree.png');

        PIXI.loader.once('complete', init);

        PIXI.loader.load();

        function init(loader, resources) {
            var stage = new PIXI.Container(),
                renderer = new PIXI.WebGLRenderer(512, 512, {
                    transparent: true
                }),
                texture = resources.image.texture,
                texture2 = resources.image2.texture;

            document.body.appendChild(renderer.view);

            var img = new PIXI.Sprite(texture);
            stage.addChild(img);
            //var img2 = new PIXI.Sprite(texture2);
            //stage.addChild(img2);

            var graphics = new GraphicsNoBlending();
            stage.addChild(graphics);
            graphics.beginFill(1, 0);
            graphics.drawRect(200, 150, 100, 200);
            graphics.endFill();


            var shadowGraphics = new ShadowGraphics();
            stage.addChild(shadowGraphics);
            shadowGraphics.beginFill(0, 0.5);
            shadowGraphics.drawRect(100, 50, 220, 200);
            shadowGraphics.endFill();

            requestAnimationFrame(update);

            function update() {
                requestAnimationFrame(update);
                renderer.render(stage);
            }
        }
    </script>

    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer placerat, sem vitae suscipit semper, eros nibh luctus sem, viverra porta purus erat id metus. Praesent egestas euismod velit non pretium. Etiam porttitor ligula elementum arcu blandit, non
    mollis mauris luctus. Nunc sodales felis ut purus bibendum ornare. Mauris accumsan, nunc sed auctor scelerisque, neque nibh ullamcorper velit, at cursus nisl felis id augue. Duis non libero arcu. Nulla ullamcorper ullamcorper tellus, eget aliquam
    neque cursus vitae. Nam commodo quam massa, quis feugiat turpis condimentum ac. Phasellus laoreet est sed risus mollis viverra. Phasellus sit amet urna leo. Praesent orci velit, vulputate eu tincidunt quis, sagittis sed lorem. Nam maximus justo et
    dolor facilisis, et cursus tellus venenatis. Nunc et mi mi. Praesent in viverra diam, at cursus felis. Suspendisse porta vestibulum magna, sed malesuada metus consectetur ac. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere
    cubilia Curae; Donec elit urna, congue rhoncus nisi interdum, laoreet ullamcorper odio. Mauris mollis nisl a nisi volutpat sodales. Donec bibendum mauris nec dui vulputate, dignissim posuere elit facilisis. Nullam a neque ipsum. Maecenas risus leo,
    consectetur in sapien fringilla, scelerisque ultricies lectus. Nulla at sem elementum ante tempus molestie nec vel urna. Proin laoreet efficitur erat vel aliquam. Aenean a orci volutpat, posuere diam at, suscipit magna. Cras ac enim at lorem elementum
    maximus id ac neque. Vestibulum ultrices varius massa ut dignissim. Donec porta volutpat ullamcorper. Sed pulvinar fringilla eros, a semper urna eleifend vehicula. Nam ut libero velit. Nam finibus tincidunt odio, sed pharetra justo mattis at. Sed
    at condimentum diam. Pellentesque tortor mi, cursus quis orci sed, elementum porttitor elit. Morbi lobortis metus sit amet ipsum euismod, sed ullamcorper mi imperdiet. Pellentesque bibendum ullamcorper justo, vel suscipit augue pellentesque ac. Sed
    faucibus, velit ac ultricies semper, turpis sem volutpat elit, in vulputate elit enim nec odio. Sed fringilla egestas nulla id placerat. Nam ac placerat nunc. Integer sed sem augue. Nullam accumsan nisi risus, sed aliquam nunc dignissim maximus. Quisque
    aliquam volutpat metus, a pellentesque nibh facilisis sed. Donec molestie nulla non vulputate sollicitudin. Morbi quis sodales turpis, in molestie tellus. Vestibulum non aliquam arcu. Nam a finibus mi, sit amet porta erat. Nulla quis tortor ut lectus
    aliquam gravida. Maecenas ut malesuada risus, sit amet mattis orci. Duis aliquet sodales mauris eget tempor. Vestibulum nulla urna, elementum nec varius in, malesuada nec magna. Aliquam eget tortor nec eros gravida suscipit. Integer faucibus nisl
    nec odio condimentum, et efficitur est pulvinar. Phasellus ac finibus leo. Proin elit metus, lacinia eget enim a, pulvinar blandit tellus. Nullam bibendum metus velit, vitae ornare ante fermentum ac. Aenean ullamcorper velit at cursus venenatis. Quisque
    tincidunt semper odio, sed ultrices nulla aliquet sit amet. Sed et faucibus tortor.



    <canvas width=" 512 " height="512 "></canvas></body>

</html>